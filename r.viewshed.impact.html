<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>r.viewshed.impact - GRASS GIS manual</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="grassdocs.css" type="text/css">
</head>
<body bgcolor="white">
<div id="container">

<a href="file:///usr/lib/grass78/docs/html/index.html"><img src="grass_logo.png" alt="GRASS logo"></a>
<hr class="header">

<h2>NAME</h2>
<em><b>r.viewshed.impact</b></em>  - Visual impact of defined exposure source<BR>
Computes visual impact of defined exposure source using weighted parametrised viewshed analysis
<h2>KEYWORDS</h2>
<a href="file:///usr/lib/grass78/docs/html/raster.html">raster</a>, <a href="file:///usr/lib/grass78/docs/html/topic_viewshed.html">viewshed</a>, <a href="file:///usr/lib/grass78/docs/html/keywords.html#line of sight">line of sight</a>, <a href="file:///usr/lib/grass78/docs/html/keywords.html#LOS">LOS</a>, <a href="file:///usr/lib/grass78/docs/html/keywords.html#exposure">exposure</a>, <a href="file:///usr/lib/grass78/docs/html/keywords.html#impact">impact</a>
<h2>SYNOPSIS</h2>
<div id="name"><b>r.viewshed.impact</b><br></div>
<b>r.viewshed.impact --help</b><br>
<div id="synopsis"><b>r.viewshed.impact</b> [-<b>crkoa</b>] <b>exposure</b>=<em>name</em> <b>column</b>=<em>string</em> <b>dsm</b>=<em>name</em>  [<b>weight</b>=<em>name</em>]   [<b>observer_elevation</b>=<em>value</em>]   [<b>range_layer</b>=<em>string</em>]   [<b>range_column</b>=<em>name</em>]   [<b>range</b>=<em>value</em>]   [<b>function</b>=<em>name</em>]   [<b>b1</b>=<em>value</em>]   [<b>sample_density</b>=<em>value</em>]   [<b>seed</b>=<em>value</em>]   [<b>refraction_coefficient</b>=<em>value</em>]   [<b>prefix</b>=<em>string</em>]   [<b>memory</b>=<em>value</em>]   [<b>cores_e</b>=<em>value</em>]   [<b>cores_i</b>=<em>value</em>]   [--<b>help</b>]  [--<b>verbose</b>]  [--<b>quiet</b>]  [--<b>ui</b>] 
</div>

<div id="flags">
<h3>Flags:</h3>
<dl>
<dt><b>-c</b></dt>
<dd>Consider the curvature of the earth (current ellipsoid)</dd>

<dt><b>-r</b></dt>
<dd>Consider the effect of atmospheric refraction in viewshed modelling</dd>

<dt><b>-k</b></dt>
<dd>Keep intermediate visual impact maps</dd>

<dt><b>-o</b></dt>
<dd>Allow intermediate visual impact maps to overwrite existing files</dd>

<dt><b>-a</b></dt>
<dd>Allow overwriting column storing visual impact values</dd>

<dt><b>--help</b></dt>
<dd>Print usage summary</dd>
<dt><b>--verbose</b></dt>
<dd>Verbose module output</dd>
<dt><b>--quiet</b></dt>
<dd>Quiet module output</dd>
<dt><b>--ui</b></dt>
<dd>Force launching GUI dialog</dd>
</dl>
</div>

<div id="parameters">
<h3>Parameters:</h3>
<dl>
<dt><b>exposure</b>=<em>name</em>&nbsp;<b>[required]</b></dt>
<dd>Name of input map of exposure source locations</dd>
<dd>Or data source for direct OGR access</dd>

<dt><b>column</b>=<em>string</em>&nbsp;<b>[required]</b></dt>
<dd>Name of attribute column to store visual impact values</dd>

<dt><b>dsm</b>=<em>name</em>&nbsp;<b>[required]</b></dt>
<dd>Name of input digital surface raster map</dd>
<dd>Name of input raster map</dd>

<dt><b>weight</b>=<em>name</em></dt>
<dd>Name of input weights raster map</dd>
<dd>Name of input raster map</dd>

<dt><b>observer_elevation</b>=<em>value</em></dt>
<dd>Observer elevation above the ground</dd>
<dd>0.0-</dd>
<dd>Options: <em>0.0-</em></dd>
<dd>Default: <em>1.5</em></dd>

<dt><b>range_layer</b>=<em>string</em></dt>
<dd>Layer number or name</dd>
<dd>Vector features can have category values in different layers. This number determines which layer to use. When used with direct OGR access this is the layer name.</dd>
<dd>Default: <em>1</em></dd>

<dt><b>range_column</b>=<em>name</em></dt>
<dd>Name of attribute column containing exposure range</dd>
<dd>Name of attribute column</dd>

<dt><b>range</b>=<em>value</em></dt>
<dd>Maximum exposure range</dd>
<dd>0.0- , -1 for infinity</dd>
<dd>Options: <em>0.0-</em></dd>

<dt><b>function</b>=<em>name</em></dt>
<dd>Viewshed parametrisation function</dd>
<dd>None, Binary, Distance_decay, Fuzzy_viewshed, Visual_magnitude, Solid_angle</dd>
<dd>Options: <em>None,  Binary,  Distance_decay,  Fuzzy_viewshed,  Visual_magnitude,  Solid_angle</em></dd>
<dd>Default: <em>Distance_decay</em></dd>

<dt><b>b1</b>=<em>value</em></dt>
<dd>Radius around the observer where clarity is perfect. Used in fuzzy viewshed function.</dd>
<dd>Default: <em>10</em></dd>

<dt><b>sample_density</b>=<em>value</em></dt>
<dd>Density of sampling points</dd>
<dd>0.0-100.0</dd>
<dd>Options: <em>0.0-100.0</em></dd>
<dd>Default: <em>25</em></dd>

<dt><b>seed</b>=<em>value</em></dt>
<dd>Random seed, default [random]</dd>
<dd>0-</dd>
<dd>Options: <em>0-</em></dd>

<dt><b>refraction_coefficient</b>=<em>value</em></dt>
<dd>Refraction coefficient</dd>
<dd>0.0-1.0</dd>
<dd>Options: <em>0.0-1.0</em></dd>
<dd>Default: <em>0.14286</em></dd>

<dt><b>prefix</b>=<em>string</em></dt>
<dd>Prefix for intermediate visual impact maps</dd>
<dd>Default: <em>visual_impact_</em></dd>

<dt><b>memory</b>=<em>value</em></dt>
<dd>Amount of memory to use in MB</dd>
<dd>1-</dd>
<dd>Options: <em>1-</em></dd>
<dd>Default: <em>500</em></dd>

<dt><b>cores_e</b>=<em>value</em></dt>
<dd>Number of cores to parallelise r.viewshed.exposure</dd>
<dd>1-</dd>
<dd>Options: <em>1-</em></dd>
<dd>Default: <em>1</em></dd>

<dt><b>cores_i</b>=<em>value</em></dt>
<dd>Number of cores to parallelise r.viewshed.impact</dd>
<dd>1-</dd>
<dd>Options: <em>1-</em></dd>
<dd>Default: <em>1</em></dd>

</dl>
</div>
<div class="toc">
<h4 class="toc">Table of contents</h4>
<ul class="toc">
    <li class="toc"><a href="#description" class="toc">DESCRIPTION</a></li>
    <li class="toc"><a href="#notes" class="toc">NOTES</a>
    <ul class="toc">
        <li class="toc"><a href="#the-algorithm" class="toc">The algorithm</a></li>
        <li class="toc"><a href="#memory-and-parallel-processing" class="toc">Memory and parallel processing</a></li>
    </ul></li>
    <li class="toc"><a href="#examples" class="toc">EXAMPLES</a></li>
    <li class="toc"><a href="#todo" class="toc">TODO</a></li>
    <li class="toc"><a href="#known-issues" class="toc">KNOWN ISSUES</a></li>
    <li class="toc"><a href="#references" class="toc">REFERENCES</a></li>
    <li class="toc"><a href="#see-also" class="toc">SEE ALSO</a></li>
    <li class="toc"><a href="#authors" class="toc">AUTHORS</a></li>
</ul>
</div>
<h2><a name="description">DESCRIPTION</a></h2>

<em>r.viewshed.impact</em> computes weighted (optional) visual impact
of each feature in a given exposure source vector map
using parametrised (optional) cumulative viewshed analysis.

<h2><a name="notes">NOTES</a></h2>

<h3><a name="the-algorithm">The algorithm</a></h3>
The processing workflow of the module consists of four steps that are
repeated iteratively for each feature of the input
exposure source vector map within the current computational region:
<ol>
<li>Random sampling of exposure source with vector points,</li>
<li>Calculating parametrised (optional) cumulative viewshed
  from random points using
  <a href="file:///usr/lib/grass78/docs/html/r.viewshed.exposurehtml">r.viewshed.exposure</a> module,</li>
<li>Optional multiplication of the (parametrised) cumulative  viewshed
  by weights raster,</li>
<li>Summarising the pixel values of the resulting visual impact
  raster and storing the value in the attribute
  table of the input exposure source map. </li>
</ol>

<div align="center" style="margin: 10px">
<a href="r_viewshed_impact_workflow.png">
<img src="r_viewshed_impact_workflow.png" width="485" height="637" alt="r.viewshed.impact workflow" border="0">
</a><br>
<i>Processing workflow</i>
</div>

<h4>1. Random sampling</h4>
The processed feature is randomly sampled by vector points
in defined sampling density (0-100%; option <b>sample_density</b>).
In general, lower sampling densities lead to lower
accuracy, higher uncertainty of the result and lower processing time,
while higher sampling densities lead to higher accuracy, lower uncertainty of
the result and longer processing time.

<h4>2. Calculating (parametrised) cumulative viewshed</h4>
The vector sampling points are then used as input into
<a href="file:///usr/lib/grass78/docs/html/r.viewshed.exposure.html">r.viewshed.exposure</a> module
to calculate (parametrised) cumulative viewshed from of the
processed feature, using the input digital surface
model (option <b>dsm</b>).
The height of the processed feature is considered
to be 0m above the input digital surface model.

<p>The following options are inherited from
<a href="file:///usr/lib/grass78/docs/html/r.viewshed.exposure.html">r.viewshed.exposure</a> module
and are thoroughly described in the documentation:
<b>observer_elevation</b>, <b>function</b>,
<b>b1_distance</b>, <b>refraction_coeff</b> and flags
<b>c</b> and <b>r</b>.

<p> The range of visual exposure can be specified either
  as constant (option <b>range_max</b>) or variable
  based on attribute value for the processed feature
  (option <b>range_col</b>).

<h4>3. (Optional) multiplication by weights raster</h4>
If the option <b>weight</b> is specified, the (parametrised)
cumulative viewshed is multiplied by a weight raster map.
This allows to account for variable visual
impact at different areas or to exclude specific areas from the
visual impact computation.

<h4>4. Summarising the visual impact value </h4>
The visual impact of the processed feature is expressed as a
sum of pixel values of the (weighted) (parametrised) cumulative
viewshed. The resulting value is stored in an
attribute table column of the input exposure source map
(option <b>column</b>). In addion, the resulting visual impact maps
created in step 3. can optionally be kept (flag <b>k</b>).

<h3><a name="memory-and-parallel-processing">Memory and parallel processing</a></h3>
Option <b>memory</b> specifies the amount of memory allocated for
viewshed computation with
<a href="file:///usr/lib/grass78/docs/html/r.viewshed.exposure.html">r.viewshed.exposure</a>.

Option <b>cores_e</b> specifies the number of cores used in
parallel processing of
<a href="file:///usr/lib/grass78/docs/html/r.viewshed.exposure.html">r.viewshed.exposure</a>.

Option <b>cores_i</b> specifies the number of cores used in
parallel processing of the iteration over exposure source map
features.

A general advice is to use smaller number in <b>cores_e</b> and larger number
in <b>cores_i</b> in processing a dataset with many small polygons/lines/points
and larger number in <b>cores_e</b> in processing a dataset with larger
polygons.

<h2><a name="examples">EXAMPLES</a></h2>
Computation of visibility of geodetic points from urban areas in South-West Wake county,
North Carolina. Input data are a terrain model, a vector map of geodetic points
(exposure source) and a raster map of urban areas (weights) from NC dataset.
Viewshed parametrisation function is set to Distance decay, exposure range
is set to 500m.

<div class="code"><pre>
# set computation region to terrain model
g.region raster=elevation@PERMANENT

# copy vector maps of geodetic points to the current mapset
g.copy vector=geodetic_swwake_pts@PERMANENT,geodetic_swwake_pts_local

# calculate visibility of geodetic points from urban areas
# keep the resulting visual impact maps
r.viewshed.impact -k
  exposure=geodetic_swwake_pts_local
  column=visibility_urban
  dsm=elevation@PERMANENT
  weight=urban@PERMANENT
  observer_elevation=1.5
  range=500
  function=Distance_decay
  sample_density=100
  seed=1
  prefix=visual_impact_
  cores_e=1
  cores_i=4

</pre></div>

<div align="center" style="margin: 10px">
<a href="r_viewshed_impact_example_overview.png">
<img src="r_viewshed_impact_example_overview.png"
width="595" height="782"
alt="Example of r.viewshed.impact - visibility value" border="0">
</a><br>
<i>Example of r.viewshed.impact - visibility value</i>
</div>

<div align="center" style="margin: 10px">
<a href="r_viewshed_impact_example_detail.png">
<img src="r_viewshed_impact_example_detail.png"
width="591" height="469"
alt="Example of r.viewshed.impact - visibility impact map" border="0">
</a><br>
<i>Example of r.viewshed.impact - visibility impact map</i>
</div>

<h2><a name="todo">TODO</a></h2>
<ul>
  <li>Implement variable exposure source height.</li>
</ul>

<h2><a name="known-issues">KNOWN ISSUES</a></h2>
<ul>
  <li>Only areas with centroid within the computational region are processed.
  Areas with centroid outside the computational region are skipped.</li>
</ul>

<h2><a name="references">REFERENCES</a></h2>
<ul>
<li>Cimburova, Z., Blumentrath, S., Barton, D., 2021. PLACE TITLE HERE. Manuscript submitted for publication.
</li>
</ul>

<h2><a name="see-also">SEE ALSO</a></h2>
<em>
<a href="file:///usr/lib/grass78/docs/html/r.viewshed.html">r.viewshed</a>,
<a href="file:///usr/lib/grass78/docs/html/r.viewshed.exposure.html">r.viewshed.exposure</a>,
<a href="file:///usr/lib/grass78/docs/html/r.viewshed.cva.html">r.viewshed.cva</a>
</em>

<h2><a name="authors">AUTHORS</a></h2>
Zofie Cimburova, <a href="https://www.nina.no">NINA</a><br>
Stefan Blumentrath, <a href="https://www.nina.no">NINA</a><h2>SOURCE CODE</h2>
<p>Available at: <a href="file:///usr/lib/grass78/docs/html//home/runner/work/r.viewshed.impact/r.viewshed.impactraster/r.viewshed.impact">r.viewshed.impact source code</a> (<a href="file:///usr/lib/grass78/docs/html//home/runner/work/r.viewshed.impact/r.viewshed.impactraster/r.viewshed.impact">history</a>)</p>
<hr class="header">
<p>
<a href="file:///usr/lib/grass78/docs/html/index.html">Main index</a> |
<a href="file:///usr/lib/grass78/docs/html/raster.html">Raster index</a> |
<a href="file:///usr/lib/grass78/docs/html/topics.html">Topics index</a> |
<a href="file:///usr/lib/grass78/docs/html/keywords.html">Keywords index</a> |
<a href="file:///usr/lib/grass78/docs/html/graphical_index.html">Graphical index</a> |
<a href="file:///usr/lib/grass78/docs/html/full_index.html">Full index</a>
</p>
<p>
&copy; 2003-2021
<a href="http://grass.osgeo.org">GRASS Development Team</a>,
GRASS GIS 7.8.6 Reference Manual
</p>

</div>
</body>
</html>
